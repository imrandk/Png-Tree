(function() {
    'use strict';

    // Function to trigger events
    function triggerEvent(element, eventName) {
        const event = new Event(eventName, { bubbles: true });
        element.dispatchEvent(event);
    }

    // Function to start the process
    function startProcess() {
        console.log('Starting process...');
        const imageElement = document.querySelector('.single-work:nth-child(1) img');
        if (imageElement) {
            console.log('Image found! Clicking...');
            imageElement.click(); // Click on the image

            // Wait for a short time to ensure the file opens
            setTimeout(() => {
                console.log('File opened. Starting main functions...');
                selectItem();
                fillBoxes();
            }, 2000); // Wait 2 seconds after clicking the image
        } else {
            console.error('Image not found!');
        }
    }

    // Function to select the first item in the dropdown
    function selectItem() {
        const item = document.querySelector('li.ivu-select-item:nth-child(1)');
        if (item) {
            console.log('Selecting item...');
            item.click();
        } else {
            console.error('Dropdown item not found!');
        }
    }

    // Function to fill the boxes
    function fillBoxes() {
        const source = document.querySelector('input.ivu-input:nth-child(3)');
        const target = document.querySelector('.work-data:nth-child(3) .ivu-input');
        const mageSpace = document.querySelector('.work-data:nth-child(4) .ivu-input');

        if (source && target) {
            console.log('Filling boxes...');
            target.value = source.value;

            // Trigger input and change events for the target field
            triggerEvent(target, 'input');
            triggerEvent(target, 'change');

            if (mageSpace) {
                mageSpace.value = 'https://www.mage.space';

                // Trigger input and change events for the mageSpace field
                triggerEvent(mageSpace, 'input');
                triggerEvent(mageSpace, 'change');
            }

            // After filling boxes, click the submit button
            setTimeout(() => {
                clickSubmitButton();
            }, 1000); // Wait 1 second before clicking the submit button
        } else {
            console.error('Source or Target not found!');
        }
    }

    // Function to click the submit button
    function clickSubmitButton() {
        const submitButton = document.querySelector('span#submit');
        if (submitButton) {
            console.log('Clicking submit button...');
            submitButton.click();

            // After clicking submit, click the default button
            setTimeout(() => {
                clickDefaultButton();
            }, 1000); // Wait 1 second before clicking the default button
        } else {
            console.error('Submit button not found!');
        }
    }

    // Function to click the default button and restart the script
    function clickDefaultButton() {
        const defaultButton = document.querySelector('span.ivu-btn-default:nth-child(1)');
        if (defaultButton) {
            console.log('Clicking default button...');
            defaultButton.click();

            // Restart the script after clicking the default button
            console.log('Restarting script...');
            setTimeout(() => {
                startProcess(); // Restart the process
            }, 2000); // Wait 2 seconds before restarting
        } else {
            console.error('Default button not found!');
        }
    }

    // Start the process initially
    startProcess();
})();
